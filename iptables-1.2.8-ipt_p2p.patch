diff -Nru iptables-1.2.8-old/extensions/Makefile iptables-1.2.8/extensions/Makefile
--- iptables-1.2.9rc1.orig/extensions/Makefile	Mon Oct 27 09:53:59 2003
+++ iptables-1.2.9rc1/extensions/Makefile	Mon Oct 27 09:55:25 2003
@@ -5,7 +5,7 @@
 # header files are present in the include/linux directory of this iptables
 # package (HW)
 #
-PF_EXT_SLIB:=ah connlimit conntrack dscp ecn esp helper stealth icmp iprange length limit mac mark multiport owner physdev pkttype realm rpc standard state tcp tcpmss tos ttl udp unclean CLASSIFY CONNMARK DNAT DSCP ECN LOG MARK MASQUERADE MIRROR NETMAP NOTRACK REDIRECT REJECT SAME SNAT TARPIT TCPMSS TOS TRACE TTL ULOG IMQ
+PF_EXT_SLIB:=ah connlimit conntrack dscp ecn esp helper stealth icmp iprange length limit mac mark multiport owner physdev pkttype realm rpc standard state tcp tcpmss tos ttl udp unclean CLASSIFY CONNMARK DNAT DSCP ECN LOG MARK MASQUERADE MIRROR NETMAP NOTRACK REDIRECT REJECT SAME SNAT TARPIT TCPMSS TOS TRACE TTL ULOG IMQ p2p
 PF6_EXT_SLIB:=eui64 hl icmpv6 length limit mac mark multiport owner standard tcp udp HL LOG MARK TRACE
 
 # Optionals
diff -Nru iptables-1.2.8-old/extensions/libipt_p2p.c iptables-1.2.8/extensions/libipt_p2p.c
--- iptables-1.2.8-old/extensions/libipt_p2p.c	1970-01-01 01:00:00.000000000 +0100
+++ iptables-1.2.8/extensions/libipt_p2p.c	2003-10-18 18:52:04.885996952 +0100
@@ -0,0 +1,63 @@
+/* Shared library add-on to iptables for unclean. */
+#include <stdio.h>
+#include <stdlib.h>
+#include <getopt.h>
+#include <iptables.h>
+
+/* Function which prints out usage message. */
+static void
+help(void)
+{
+	printf(
+"p2p v%s takes no options\n"
+"\n", IPTABLES_VERSION);
+}
+
+static struct option opts[] = {
+	{0}
+};
+
+/* Initialize the match. */
+static void
+init(struct ipt_entry_match *m, unsigned int *nfcache)
+{
+	/* Can't cache this. */
+	*nfcache |= NFC_UNKNOWN;
+}
+
+/* Function which parses command options; returns true if it
+   ate an option */
+static int
+parse(int c, char **argv, int invert, unsigned int *flags,
+      const struct ipt_entry *entry,
+      unsigned int *nfcache,
+      struct ipt_entry_match **match)
+{
+	return 0;
+}
+
+/* Final check; must have specified --mac. */
+static void final_check(unsigned int flags)
+{
+}
+
+static
+struct iptables_match p2p
+= { NULL,
+    "p2p",
+    IPTABLES_VERSION,
+    IPT_ALIGN(0),
+    IPT_ALIGN(0),
+    &help,
+    &init,
+    &parse,
+    &final_check,
+    NULL, /* print */
+    NULL, /* save */
+    opts
+};
+
+void _init(void)
+{
+	register_match(&p2p);
+}
